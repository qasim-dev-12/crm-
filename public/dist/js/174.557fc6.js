/*! For license information please see 174.557fc6.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[174],{559:function(t,e,r){"use strict";r.r(e);var n=r(4),s=r(5),i=r(3),o=r.n(i);function a(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",s=r.toStringTag||"@@toStringTag";function i(r,n,s,i){var a=n&&n.prototype instanceof l?n:l,u=Object.create(a.prototype);return c(u,"_invoke",function(r,n,s){var i,a,c,l=0,u=s||[],m=!1,f={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,r){return i=e,a=0,c=t,f.n=r,o}};function d(r,n){for(a=r,c=n,e=0;!m&&l&&!s&&e<u.length;e++){var s,i=u[e],d=f.p,p=i[2];r>3?(s=p===n)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((s=r<2&&d<i[1])?(a=0,f.v=n,f.n=i[1]):d<p&&(s=r<3||i[0]>n||n>p)&&(i[4]=r,i[5]=n,f.n=p,a=0))}if(s||r>1)return o;throw m=!0,n}return function(s,u,p){if(l>1)throw TypeError("Generator is already running");for(m&&1===u&&d(u,p),a=u,c=p;(e=a<2?t:c)||!m;){i||(a?a<3?(a>1&&(f.n=-1),d(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(s="next"),e=i[s]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+s+"' method"),a=1);i=t}else if((e=(m=f.n<0)?c:r.call(n,f))!==o)break}catch(e){i=t,a=1,c=e}finally{l=1}}return{value:e,done:m}}}(r,s,i),!0),u}var o={};function l(){}function u(){}function m(){}e=Object.getPrototypeOf;var f=[][n]?e(e([][n]())):(c(e={},n,(function(){return this})),e),d=m.prototype=l.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,c(t,s,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=m,c(d,"constructor",m),c(m,"constructor",u),u.displayName="GeneratorFunction",c(m,s,"GeneratorFunction"),c(d),c(d,s,"Generator"),c(d,n,(function(){return this})),c(d,"toString",(function(){return"[object Generator]"})),(a=function(){return{w:i,m:p}})()}function c(t,e,r,n){var s=Object.defineProperty;try{s({},"",{})}catch(t){s=0}(c=function(t,e,r,n){function i(e,r){c(t,e,(function(t){return this._invoke(e,r,t)}))}e?s?s(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(i("next",0),i("throw",1),i("return",2))})(t,e,r,n)}function l(t,e,r,n,s,i,o){try{var a=t[i](o),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,s)}function u(t){return function(){var e=this,r=arguments;return new Promise((function(n,s){var i=t.apply(e,r);function o(t){l(i,n,s,o,a,"next",t)}function a(t){l(i,n,s,o,a,"throw",t)}o(void 0)}))}}var m={middleware:["auth","check-permissions"],metaInfo:function(){return{title:this.$t("Edit Role")}},data:function(){return{breadcrumbsCurrent:"Edit Role",breadcrumbs:[{name:"Dashboard",url:"home"},{name:"Setup",url:"setup.index"},{name:"Roles & Permissions",url:"roles.index"},{name:"Edit",url:""}],form:new s.a({name:null,permission:[]}),loading:!0,isDemoMode:window.config.isDemoMode}},computed:Object(n.b)({items:"operations/items"}),mounted:function(){this.getPermission(),this.getRole()},methods:{getRole:function(){var t=this;return u(a().m((function e(){var r,n;return a().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,o.a.get(window.location.origin+"/api/roles/"+t.$route.params.slug);case 1:r=e.v,n=r.data,t.form.name=n.data.name,t.form.permission=n.data.permissions;case 2:return e.a(2)}}),e)})))()},getPermission:function(){var t=this;return u(a().m((function e(){return a().w((function(e){for(;;)switch(e.n){case 0:return t.loading=!0,e.n=1,t.$store.dispatch("operations/allData",{path:"/api/all-permissions"});case 1:t.loading=!1;case 2:return e.a(2)}}),e)})))()},onChangeEventHandler:function(t,e){if(e.includes("view")||e.includes("edit")||e.includes("delete")){var r=e.includes("delete")?e.substring(0,e.length-6):e.substring(0,e.length-4);this.form.permission.includes(e)&&!this.form.permission.includes(r+"list")&&this.form.permission.push(r+"list")}if(e.includes("list")&&!this.form.permission.includes(e)){var n=e.substring(0,e.length-4);this.form.permission=this.form.permission.filter((function(t){return n+"edit"!==t})),this.form.permission=this.form.permission.filter((function(t){return n+"delete"!==t})),this.form.permission=this.form.permission.filter((function(t){return n+"view"!==t}))}},updateRole:function(){var t=this;return u(a().m((function e(){return a().w((function(e){for(;;)switch(e.n){case 0:if(t.isDemoMode){e.n=2;break}return e.n=1,t.form.patch(window.location.origin+"/api/roles/"+t.$route.params.slug).then((function(){toast.fire({type:"success",title:t.$t("Role updated successfully")}),t.$router.push({name:"roles.index"})})).catch((function(){toast.fire({type:"error",title:t.$t("Opps...something went wrong")})}));case 1:e.n=3;break;case 2:toast.fire({type:"warning",title:t.$t("You are not allowed to do this in demo version.")});case 3:return e.a(2)}}),e)})))()}}},f=r(1),d=Object(f.a)(m,(function(){var t=this,e=t._self._c;return e("div",[e("breadcrumbs",{attrs:{items:t.breadcrumbs,current:t.breadcrumbsCurrent}}),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 col-xl-3"},[e("SettingsSidebar")],1),t._v(" "),e("div",{staticClass:"col-12 col-xl-9"},[e("form",{on:{submit:function(e){return e.preventDefault(),t.updateRole.apply(null,arguments)},keydown:function(e){return t.form.onKeydown(e)}}},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header setings-header"},[e("div",{staticClass:"col-xl-4 col-4"},[e("h3",{staticClass:"card-title"},[t._v("\n                "+t._s(t.$t("Edit role"))+"\n              ")])]),t._v(" "),e("div",{staticClass:"col-xl-8 col-8 float-right text-right"},[e("router-link",{staticClass:"btn btn-dark float-right",attrs:{to:{name:"roles.index"}}},[e("i",{staticClass:"fas fa-long-arrow-alt-left"}),t._v("\n                "+t._s(t.$t("Back"))+"\n              ")])],1)]),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group mb-4"},[e("label",{attrs:{for:"name"}},[t._v(t._s(t.$t("Name")))]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("name")},attrs:{placeholder:t.$t("Enter a name")},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}}),t._v(" "),e("has-error",{attrs:{form:t.form,field:"name"}})],1),t._v(" "),e("h5",{staticClass:"mb-3 mt-4"},[t._v("\n              "+t._s(t.$t("Update Permissions:"))+"\n            ")]),t._v(" "),e("masonry",{attrs:{cols:{default:2,1e3:2,700:1,400:1},gutter:{default:"30px",700:"15px"}}},t._l(t.items,(function(r,n){return e("div",{key:n,class:{"is-invalid":t.form.errors.has("permission")}},[e("has-error",{staticClass:"permission",attrs:{form:t.form,field:"permission"}}),t._v(" "),e("div",{staticClass:"card permission-card"},[e("div",{staticClass:"card-header"},[r[0]?e("h5",{staticClass:"card-title text-bold text-capitalize"},[t._v("\n                      "+t._s(r[0].guard_name)+"\n                    ")]):t._e(),t._v(" "),e("div",{staticClass:"card-tools"},[e("button",{staticClass:"btn btn-tool",attrs:{type:"button",loading:t.form.busy,"data-card-widget":"collapse"}},[e("i",{staticClass:"fas fa-minus"})])])]),t._v(" "),e("div",{staticClass:"card-body permisson-card"},[e("ul",t._l(r,(function(r,n){return e("li",{key:n},[e("label",{staticClass:"text-capitalize",attrs:{for:r.slug}},[t._v(t._s(r.name))]),t._v(" "),e("div",{staticClass:"custom-control custom-checkbox mb-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.permission,expression:"form.permission"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:r.slug,name:"permission"},domProps:{value:r.slug,checked:Array.isArray(t.form.permission)?t._i(t.form.permission,r.slug)>-1:t.form.permission},on:{change:[function(e){var n=t.form.permission,s=e.target,i=!!s.checked;if(Array.isArray(n)){var o=r.slug,a=t._i(n,o);s.checked?a<0&&t.$set(t.form,"permission",n.concat([o])):a>-1&&t.$set(t.form,"permission",n.slice(0,a).concat(n.slice(a+1)))}else t.$set(t.form,"permission",i)},function(e){return t.onChangeEventHandler(e,r.slug)}]}}),t._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:r.slug}})])])})),0)])])],1)})),0)],1),t._v(" "),e("div",{staticClass:"card-footer"},[e("v-button",{staticClass:"btn btn-primary",attrs:{loading:t.form.busy}},[e("i",{staticClass:"fas fa-edit"}),t._v(" "+t._s(t.$t("Save changes"))+"\n            ")])],1)])])])])],1)}),[],!1,null,null,null);e.default=d.exports}}]);