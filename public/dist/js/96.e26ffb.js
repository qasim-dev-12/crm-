/*! For license information please see 96.e26ffb.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{448:function(e,t,r){"use strict";r.r(t);var n=r(5),a=r(63),o=r.n(a);function i(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function o(r,n,a,o){var i=n&&n.prototype instanceof u?n:u,l=Object.create(i.prototype);return s(l,"_invoke",function(r,n,a){var o,i,s,u=0,l=a||[],d=!1,p={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,r){return o=t,i=0,s=e,p.n=r,c}};function m(r,n){for(i=r,s=n,t=0;!d&&u&&!a&&t<l.length;t++){var a,o=l[t],m=p.p,f=o[2];r>3?(a=f===n)&&(s=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=m&&((a=r<2&&m<o[1])?(i=0,p.v=n,p.n=o[1]):m<f&&(a=r<3||o[0]>n||n>f)&&(o[4]=r,o[5]=n,p.n=f,i=0))}if(a||r>1)return c;throw d=!0,n}return function(a,l,f){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&m(l,f),i=l,s=f;(t=i<2?e:s)||!d;){o||(i?i<3?(i>1&&(p.n=-1),m(i,s)):p.n=s:p.v=s);try{if(u=2,o){if(i||(a="next"),t=o[a]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=e}else if((t=(d=p.n<0)?s:r.call(n,p))!==c)break}catch(t){o=e,i=1,s=t}finally{u=1}}return{value:t,done:d}}}(r,a,o),!0),l}var c={};function u(){}function l(){}function d(){}t=Object.getPrototypeOf;var p=[][n]?t(t([][n]())):(s(t={},n,(function(){return this})),t),m=d.prototype=u.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=d,s(m,"constructor",d),s(d,"constructor",l),l.displayName="GeneratorFunction",s(d,a,"GeneratorFunction"),s(m),s(m,a,"Generator"),s(m,n,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),(i=function(){return{w:o,m:f}})()}function s(e,t,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(s=function(e,t,r,n){function o(t,r){s(e,t,(function(e){return this._invoke(t,r,e)}))}t?a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(o("next",0),o("throw",1),o("return",2))})(e,t,r,n)}function c(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){c(o,n,a,i,s,"next",e)}function s(e){c(o,n,a,i,s,"throw",e)}i(void 0)}))}}var l={components:{Button:r(111).a},layout:"basic",middleware:"guest",metaInfo:function(){return{title:this.$t("Otp Verification")}},data:function(){return{form:new n.a({otp_number:"",token_number:localStorage.getItem("otp_token")}),timer:120,interval:null,isExpired:!1,errorMessage:"",verifyLoading:!1,resendLoading:!1}},computed:{formattedTime:function(){var e=Math.floor(this.timer/60),t=this.timer%60;return"".concat(e.toString().padStart(2,"0"),":").concat(t.toString().padStart(2,"0"))}},methods:{verifyOTP:function(){var e=this;return u(i().m((function t(){var r,n,a,o;return i().w((function(t){for(;;)switch(t.p=t.n){case 0:if(!e.isExpired){t.n=1;break}return alert("OTP has expired. Please request a new OTP."),t.a(2);case 1:return e.verifyLoading=!0,t.p=2,t.n=3,e.form.post("/api/verify-otp");case 3:if(r=t.v,!(n=r.data).token){t.n=6;break}return localStorage.removeItem("otp_timer"),t.n=4,e.$store.dispatch("auth/saveToken",{token:n.token,remember:e.remember});case 4:return t.n=5,e.$store.dispatch("auth/fetchUser");case 5:e.redirect(),t.n=7;break;case 6:e.errorMessage=n.message||"Verification failed.";case 7:t.n=9;break;case 8:t.p=8,o=t.v,a="OTP verification failed.",o.response&&o.response.data&&(o.response.data.message&&(a=o.response.data.message),o.response.data.errors&&e.form.errors.set(o.response.data.errors)),e.errorMessage=a;case 9:return t.p=9,e.verifyLoading=!1,t.f(9);case 10:return t.a(2)}}),t,null,[[2,8,9,10]])})))()},redirect:function(){var e=o.a.get("intended_url");e?(o.a.remove("intended_url"),this.$router.push({path:e})):this.$router.push({name:"home"})},startTimer:function(){var e=this;this.interval=setInterval((function(){e.timer>0?e.timer--:(e.isExpired=!0,clearInterval(e.interval))}),1e3)},resendOTP:function(){var e=this;return u(i().m((function t(){var r,n,a;return i().w((function(t){for(;;)switch(t.p=t.n){case 0:return e.resendLoading=!0,t.p=1,t.n=2,e.form.post("/api/resend-otp");case 2:r=t.v,"otp_resent"===(n=r.data).status?(a=n.otp_expiration_time||2,e.timer=60*a,e.isExpired=!1,localStorage.setItem("otp_timer",Date.now()),clearInterval(e.interval),e.startTimer(),e.errorMessage=n.message||"OTP has been resent. Please check your email."):e.errorMessage="Something went wrong.",t.n=4;break;case 3:t.p=3,t.v,e.errorMessage="Failed to resend OTP. Please try again later.";case 4:return t.p=4,e.resendLoading=!1,t.f(4);case 5:return t.a(2)}}),t,null,[[1,3,4,5]])})))()}},mounted:function(){var e=localStorage.getItem("otp_timer"),t=localStorage.getItem("otp_expiration_time");if(e){var r=Math.floor((Date.now()-e)/1e3),n=60*(t||2);this.timer=Math.max(n-r,0),0===this.timer?this.isExpired=!0:this.startTimer()}else{var a=localStorage.getItem("otp_expiration_time")||2;this.timer=60*a,localStorage.setItem("otp_timer",Date.now()),localStorage.setItem("otp_expiration_time",a),this.startTimer()}},beforeDestroy:function(){clearInterval(this.interval)}},d=r(1),p=Object(d.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"container-fluid"},[t("div",{staticClass:"row no-gutter"},[t("div",{staticClass:"col-md-6 d-none d-md-flex bg-image"}),e._v(" "),t("div",{staticClass:"col-md-6 bg-light"},[t("div",{staticClass:"auth-wrapper d-flex align-items-center py-5"},[t("div",{staticClass:"container"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-lg-10 col-xl-7 mx-auto"},[t("p",{staticClass:"text-muted mb-4 mt-2"},[e._v("\n                "+e._s(e.$t("Otp sent to your email. Please check your email!"))+"\n              ")]),e._v(" "),t("form",{on:{submit:function(t){return t.preventDefault(),e.verifyOTP.apply(null,arguments)},keydown:function(t){return e.form.onKeydown(t)}}},[t("div",{staticClass:"form-group mb-3"},[t("label",{attrs:{for:"otp_number"}},[e._v(e._s(e.$t("Otp Number"))+"\n                    "),t("span",{staticClass:"required"},[e._v("*")])]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.otp_number,expression:"form.otp_number"}],staticClass:"form-control rounded-pill border-0 shadow-sm px-4 text-primary",class:{"is-invalid":e.form.errors.has("otp_number")},attrs:{type:"number",name:"otp_number",placeholder:e.$t("Enter valid OTP number")},domProps:{value:e.form.otp_number},on:{input:function(t){t.target.composing||e.$set(e.form,"otp_number",t.target.value)}}}),e._v(" "),e.errorMessage?t("div",{staticClass:"text-danger"},[e._v("\n                    "+e._s(e.errorMessage)+"\n                  ")]):e._e()]),e._v(" "),t("div",{staticClass:"text-danger mb-3"},[e.isExpired?t("strong",{staticClass:"text-danger"},[e._v("\n                    "+e._s(e.$t("OTP expired. Please resend code."))+"\n                  ")]):t("strong",[e._v(e._s(e.formattedTime))])]),e._v(" "),t("v-button",{staticClass:"btn btn-primary btn-block text-uppercase mb-2 rounded-pill shadow-sm",attrs:{loading:e.verifyLoading,disabled:e.isExpired}},[t("i",{staticClass:"fas fa-sign-in-alt"}),e._v(" "),t("strong",[e._v(e._s(e.$t("Verify")))])])],1),e._v(" "),e.isExpired?t("button",{staticClass:"btn btn-secondary btn-block text-uppercase mb-2 rounded-pill shadow-sm",attrs:{disabled:e.resendLoading},on:{click:e.resendOTP}},[e.resendLoading?e._e():t("i",{staticClass:"fas fa-redo"}),e._v(" "),e.resendLoading?t("i",{staticClass:"fas fa-spinner fa-spin"}):e._e(),e._v(" "),t("strong",[e._v(e._s(e.$t("Resend Code")))])]):e._e()])])])])])])])}),[],!1,null,null,null);t.default=p.exports}}]);